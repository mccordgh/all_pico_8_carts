pico-8 cartridge // http://www.pico-8.com
version 15
__lua__
-- snowflake table tutorial

function _init()
	flakes = {}
end

function make_flake(x, y)
	local f = {}
	
	f.x = x
	f.y = y
	
	f.ax = 0
	f.ay = 0
	f.frame_speed = rnd(4) + 1
	f.frame_count = 0
	
	f.frame = 1
	
	add(flakes, f )
end

function _update()
	flake_chance = rnd(10)
	
	if (flake_chance > 8) then
		make_flake(rnd(120), -8)
	end

	foreach(flakes, flake_physics)
end

function flake_physics(f)
	 f.x += f.ax
	 f.y += f.ay
	 
	 f.ay += rnd(0.01)
	 f.ax += (rnd(0.1) - 0.05)
	 
	 f.frame_count += 1
	 
	 if (f.frame_count >= f.frame_speed) then
	  f.frame += 1
	  f.frame_count = 0
	 end
	 
	 if (f.frame >= 5) then
	 	f.frame = 1
	 end
	 
	 if (f.y > 128) then
	 	f.y = -8
	 	f.ay = 0
	 end
end

function _draw()
	cls()
	
	foreach(flakes, draw_flake)
end

function draw_flake(f)
	-- draws one flake from
	-- table flakes
	spr(f.frame, f.x, f.y)
	
end
__gfx__
00000000005070500005550000005000000555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000056070650055755000006000005575500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000676000007670000006000000767000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000077777770066766000006000006676600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000676000007670000006000000767000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700056070650055755000006000005575500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000005070500005550000005000000555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
