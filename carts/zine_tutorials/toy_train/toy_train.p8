pico-8 cartridge // http://www.pico-8.com
version 15
__lua__
function _init()
 cls()
 switch_state = 0
 train = {{64,8}, {72,8}, {80,8}}
end

function move_segment(s, dir)
  spd = dir * 2

  --top side
  if (s[2] == 8) then
    --top right
    if (s[1] == 112) then
   			s[2] += spd
  		else
   			s[1] += spd
  		end
 	else
 	-- right side
 	if (s[1] == 112) then
 			-- bottom right
  		if (s[2] == 112) then
     	s[1] -= spd
    else
    		s[2] += spd
    end
  else
  -- bottom side
  if 	(s[2] == 112) then
  		-- bottom side
  		if (s[1] == 8) then
  			 s[2] -= spd
  		else
  				s[1] -= spd
  		end
  else
  --left side
  if (s[1] == 8) then
  		--top left
    if (s[2] == 8) then
      s[1] += spd
    else
      s[2] -= spd
    end
  end
end
end
end
end

function advance_switch()
  if (switch_state < 1) then
    switch_state = 1
  else
    switch_state = 0
  end
end

function move_train()
  for t in all(train) do
    move_segment(t, switch_state)
  end
end

function _update()
  if (btnp(4)) then
    advance_switch()
  end
  
  move_train()
end

function draw_train()
  local len = count(train)
		
	for t = 1, len do
    if (t == 1) then
      sprite = 11
    else if (t == len) then
      sprite = 13
    else
      sprite = 12
    end
  end

  spr(sprite, train[t][1], train[t][2])	
end
end

function draw_switch()
  if (switch_state == 1) then
    sspr(0, 16, 16, 16, 56, 56, 16, 16)
  else
    sspr(64, 16, 16, 16, 56, 56, 16, 16)
  end
end

function _draw()
  map(0, 0, 0, 0, 16, 16)
  draw_switch()
  draw_train()
end
__gfx__
00000000000000004444444554444444444444444444444444444444666667660dddddd00dddddd00dddddd00dddddd00dddddd00dddddd00000000000000000
0000000000000000455444444554444446666666666666666666666466666666dd5dd5d0dd5dd5dd0d5dd5ddd555555dd555555dd555555d0000000000000000
0070070000000000445444444455444446555555555555555555556465676656dd5dd5d0dd5dd5dd0d5dd5ddd5dddd5dd5dddd5dd5dddd5d0000000000000000
0007700000000000455455444445554446566466466646664664656466666666dd5665606d5665d6065665ddd5dddd5dd5d55d5dd5d11d5d0000000000000000
0007700000000000454445444444454446546466466646664646656466666666dd5665606d5665d6065665ddd5dddd5dd5d55d5dd5d11d5d0000000000000000
0070070000000000444445544444444446564555555555555554456467666566dd5dd5d0dd5dd5dd0d5dd5ddd5dddd5dd5dddd5dd5dddd5d0000000000000000
0000000000000000444444544444444446566566666666666656656466566676dd5dd5d0dd5dd5dd0d5dd5ddd555555dd555555dd555555d0000000000000000
00000000000000004444445444444544465665644444444446566564666666660dddddd00dddddd00dddddd00dddddd00dddddd00dddddd00000000000000000
00000000000000004444455444444444465445644444444446544564444884440dddddd00dd66dd0000000000000000000000000000000000000000000000000
0000000000000000444445444444445446566564844444484656656444877844ddddddddddddddddddd66ddd0000000000000000000000000000000000000000
0000000000000000444455444455444446566564884444884656656448777784d555555dd555555dd555555d0000000000000000000000000000000000000000
0000000000000000444554444544444446566564878448784656656487788778ddd66dddddd66dddddd66ddd0000000000000000000000000000000000000000
0000000000000000445544445544444446544564877887784654456487844878ddd66dddddd66dddddd66ddd0000000000000000000000000000000000000000
0000000000000000445444445444444446566564487777844656656488444488d555555dd555555dd555555d0000000000000000000000000000000000000000
0000000000000000454444444554444446566564448778444656656484444448ddd66ddddddddddddddddddd0000000000000000000000000000000000000000
0000000000000000444444444454444446544564444884444654456444444444000000000dd66dd00dddddd00000000000000000000000000000000000000000
00005555550000000000555555000000465665644444444446566564666666660000555775000000000000000000000000000000000000000000000000000000
00055555555500000005555555550000465665666666666666566564699599960005557777550000000000000000000000000000000000000000000000000000
00055555555777700005555555555000465445555555555555546564699959960005557777555000000000000000000000000000000000000000000000000000
0055555555dd7770005555555555500046566466646646646646456469555596005555dddd555000000000000000000000000000000000000000000000000000
055555555dddd770055555555555550046564666646646646646656469555596055555dddd555500000000000000000000000000000000000000000000000000
05555555dddddd70055555555555555046555555555555555555556469995996055555dddd555550000000000000000000000000000000000000000000000000
5555555dddddd555ddddddddddddd77546666666666666666666666469959996555555dddd555555000000000000000000000000000000000000000000000000
555555ddddddd555ddddddddddddd77744444444444444444444444466666666555555dddd555555000000000000000000000000000000000000000000000000
55555ddddddd5555ddddddddddddd77767666666666666566666666666665666555555dddd555555000000000000000000000000000000000000000000000000
0555ddddddd55555ddddddddddddd77566666699599966666666699559996666055555dddd555555000000000000000000000000000000000000000000000000
055ddddddd555550055555555555555065667699959966666766795995996676055555dddd555550000000000000000000000000000000000000000000000000
055ddddddd555550055555555555555066666695555965666656659959596666055555dddd555550000000000000000000000000000000000000000000000000
000dddddd5555500000555555555550066656695555966666666659599596666000555dddd555500000000000000000000000000000000000000000000000000
0000ddd555555500000055555555550066666699959966766666695995996656000055dddd555500000000000000000000000000000000000000000000000000
0000055555555000000005555555500066766799599966666567699559996666000005dddd555000000000000000000000000000000000000000000000000000
0000005555550000000000555555000066666666666666666666666666667666000000dddd550000000000000000000000000000000000000000000000000000
__map__
0203020302030203021502020302030203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1204050505050505050505050505060203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0214020302030203021703020302161213000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214121312131213121213121312160203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0214020302030203020203020302161213000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214121312131213121213121312160203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0214020302030736372703020302161213000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214121312130707070713121312160203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0214020302030707070703020302161213000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214121312130707070713121312160203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0214030203020302030203020302161213000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214131213121312131213121312160203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0214030203020302030203020302161213000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214131213121312131213121312160203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0224252525252525252525252525261213000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1213131213121312131213121312131213000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
