pico-8 cartridge // http://www.pico-8.com
version 15
__lua__

function _init()
	player_x = 64
	player_y = 64
	player_ax = 0
	player_ay = 0
	
	friction = .05
	 
	char_type = 1
	solid = false
end

function player_move()
	if (btn(0)) then
		if (is_solid(player_x-1, player_y) == false) then
			player_ax -= 0.1
		end
	end 
	
	if (btn(1)) then
		if (is_solid(player_x+8, player_y) == false) then
			player_ax += 0.1
		end
	end
	
	if (btn(2)) then
		if (is_solid(player_x, player_y-1) == false) then	
			player_ay -= 0.1
		end
	end
	
	if (btn(3)) then
		if (is_solid(player_x, player_y+8) == false) then	
			player_ay += 0.1
		end
	end
end

function _update()
	solid = is_solid(player_x, player_y)

	player_move()
	
	if (btnp(4)) then
		char_type += 1
		sfx(0)
		
		if (char_type >= 5) then
			char_type = 1
		end
	end
		
	player_x += player_ax
	player_y += player_ay
	
	add_friction()
end

function add_friction()
	if (player_ax > 0) then
		player_ax -= friction
	end
	
	if (player_ax < 0) then
		player_ax += friction
	end
	
	if (player_ay > 0) then
		player_ay -= friction
	end
	
	if (player_ay < 0) then
		player_ay += friction
	end
end

function draw_bg()
	rectfill(0,0,128,128,0)
	
	map(0,0,0,0)
end

function _draw()
	draw_bg()
	
	spr(char_type, player_x, player_y)
	debug_info()
end

function debug_info()
 tile_x = (player_x - (player_x % 8)) / 8
 tile_y = (player_y - (player_y % 8)) / 8
	
	print("player: "..player_x..", "..player_y, 9, 8, 7)
	print("tile: "..tile_x..", "..tile_y, 9, 14, 7)
	print(solid, 9, 20)
	print("accel: "..player_ax..", "..player_ay, 9, 26, 7)
end

function is_solid(x, y)
	local tilex = (x - (x % 8)) / 8
 local tiley = (y - (y % 8)) / 8
	local tile = mget(tilex, tiley)
	
	return fget(tile, 0)
	
end
__gfx__
00000000cccccccc0000000000000000000bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000c777777c099999900e2222ee00bbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700c707707c009a9a000202022203bbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000c777777c00999900022222220bb0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000c700007c0099a90002022202bbb3b3b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700c776677c0099a900022000223bbb0bb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000c677776c009999000e22222e03bbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000cccccccc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2eeeeeef000900001111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1222222e009900006666166600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1222222e99aaf0005555155500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1222222e09aa99005555155500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1222222e009fbb001111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1222222e00900bb06666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1222222e000000b05555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111112000000b05555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
4040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4000000000000041000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4000004100000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4000004040404000000000004100004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4000000000004000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4000000000404000004100000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000040400000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000404040000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000410000000000404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000404000404042424242424000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000004100404040404042424242424000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000041000000404242424242424000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000424242424242424000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4000410000000000404040404042424000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000005006550065500655006550065500655006550065500655006550065500655006550065500655006550065500755007550075500755007550075500755007550075500755007550075500755007550
00010000075500755007550075500655004550015500155001550086000a6000c600076000e6000e6000e6000e6000e6000e6000f6000f6000e6000c600086000660004600046000460005600066000760009600
